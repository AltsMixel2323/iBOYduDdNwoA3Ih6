if not script_key and not DitPSX then
    getgenv().DitPSX = {
        ["Auto Triple Damage Boost"] = {
            ["Boost"] = true,
            ["Server"] = true
        },
        ["Auto Farm Fruit"] = { -- Only check for Orange/Apple fruit
            ["Enable"] = true,
            ["Farm when under"] = 40
        },
        ["Auto Mailbox"] = { -- Auto send Diamonds to a person thru Mailbox when your Diamonds more than set diamond
            ["Enable"] = true,
            ["Send to"] = "egodwastaken",
            ["Above amount"] = 100000000000
        },
        ["Auto Claim Mailbox"] = true, -- Claim Diamonds on the account received the Diamonds from Auto Mailbox
        ["Auto Daycare"] = true, -- Auto Claim Daycare and Enroll unequipped/unlocked Pets in your Inventory
        ["Auto Leave"] = {
            ["Ping Froze"] = true,
            ["Got kicked"] = true,
            ["Leave Timer"] = {
                ["Enable"] = true,
                ["After seconds"] = 30*60 -- Auto Leave the server after AFK in for set seconds 
            }
        },
        ["Hop Server"] = {
            ["Hop Server Cooldown"] = 15*60, -- Wait set second after Hop Server
            ["Player nearby"] = false, -- Will hop to low player server if there's a player nearby Mystic Mine (2m cooldown)
            ["Out of diamond"] = false, -- Will hop to low player server if there are no diamond left to farm
        },
        ["Farm Cooldown"] = 0, -- Delay between switch to farm another thing (higher = less crashing)
        ["Send all"] = false, -- Send all pet to break or not, false will send single to break
        ["Performance Mode"] = false, -- Enable if you want to AFK overnight, farm will be slower but low chance crashing roblox 
        ["Swap to Cyber Cavern"] = true, -- Will swap to Cyber Cavern if Mystic Mine out of Diamonds
        ["White Screen"] = true,
        ["Discord Webhook"] = {
            ["Stats Tracker"] = {
                ["Url"] = "",
                ["Cooldown"] = 60*60, -- Will notify every set seconds
            }, 
            ["Hop Server"] = "https://discord.com/api/webhooks/1117383501352800387/FaHzAjgAKFiUpxM7J4iOV_BbwGHdKb9pUbBOFadOBIY5HqwqdkqLJUhGyMvlSTRDbBq4",
            ["Mailbox"] = "https://discord.com/api/webhooks/1117383548098326649/dElhcBLhQhLRZBTGocxOwjRymFCyXPCiZz-nTfcvuOt64i6Jz9vjoiTMWd3AQ7i1zVGB",
        },
    }
    getgenv().Setting = {
        UID = 29,
        DelayUpdate = 60;
        Note = 'them chit gai alim'
    }
end
if Setting then
    spawn(function()
        repeat wait(1)
        until dg and S_Timer
        local delayUpdate = Setting.DelayUpdate >= 60 and Setting.DelayUpdate or 60
        getgenv().UpdateDashboard = function()
            if LastDashboardUpdate and tick() - LastDashboardUpdate < 20 then return end
            local data = {}
            data['UID'] = Setting.UID 
            data['Username'] = game:GetService('Players').LocalPlayer.Name
            data['gameId'] = tostring(game.GameId)
            data['Note'] = getgenv().Setting.Note
            data['Packet'] = {}
            data['Packet']['Total Diamond'] = game:GetService('Players').LocalPlayer['leaderstats']:FindFirstChild('Diamonds').Value
            data['Packet']['Diamond Gained'] = dg
            data['Packet']['Time Elapsed'] = S_Timer
            local url = 'https://api.chimovo.com/v1/data/updateData';
            local responses = http_request({
                    Url = url,
                    Method = "POST",
                    Headers = {
                        ["Content-Type"] = "application/json"
                    },
                    Body = game:GetService("HttpService"):JSONEncode(data)
                }
            )
            getgenv().LastDashboardUpdate = tick()
        end
        while wait() do
            pcall(UpdateDashboard)
            wait(delayUpdate)
        end
    end)
end
    
if Executed then return end
getgenv().Executed = true

repeat wait()
until game:IsLoaded()
and game.Players.LocalPlayer
and game.Players.LocalPlayer:FindFirstChild("leaderstats")

local plr = game.Players.LocalPlayer

function Kick(v)
    plr:Kick(v)
end

if not DitPSX then return Kick("Config not found\nPlease check out #script-config channel") end

local Http = game:GetService("HttpService")
local TPS = game:GetService("TeleportService")
local Api = "https://games.roblox.com/v1/games/"
local _place = game.PlaceId 
local _servers = Api.._place.."/servers/Public?sortOrder=Asc&limit=100"
function ListServers(cursor)
   local Raw = game:HttpGet(_servers .. ((cursor and "&cursor="..cursor) or ""))
   return Http:JSONDecode(Raw)
end
function TPReturner()
    local Server, Next; repeat
        local Servers = ListServers(Next)
        Server = Servers.data[1]
        Next = Servers.nextPageCursor
    until Server
    TPS:TeleportToPlaceInstance(_place, Server.id, game.Players.LocalPlayer)
end

function HopServer()
    getgenv().StartedHopServer = true
    spawn(function()
        while wait() do
            wait(2)
            pcall(function()
                TPReturner()
            end)
        end
    end)
end
getgenv().hopserver = Instance.new("BindableEvent")
getgenv().hopserver.Event:Connect(function() 
    HopServer()
end)

function LeaveOrHop()
    pcall(UpdateDashboard)
    if DitPSX["Hop Server"]["Out of diamond"] or DitPSX["Hop Server"]["Player nearby"] then
        queue_on_teleport("getgenv().LastHopTick = " .. tick())
        getgenv().hopserver:Fire()
    else
        game:Shutdown()
    end
    wait(10)
end

if true then
    local LoadingCount = tick()
    repeat wait(1)
        pcall(function()
            for i, v in ipairs(getconnections(plr.PlayerGui["__INTRO"].Frame.Skip.MouseButton1Up)) do
                v.Function()
            end
        end)
        pcall(function()
            if tick() - LoadingCount > 60 or plr.PlayerGui["__INTRO"].Frame.Notice.Visible then 
                LeaveOrHop()
            end
        end)
    until not plr.PlayerGui:FindFirstChild("__INTRO")
    repeat wait(1)
    until plr.PlayerGui:FindFirstChild("Loading")
    and not plr.PlayerGui:FindFirstChild("Loading").Enabled
    and plr:FindFirstChild("__LOADED") and plr["__LOADED"].Value
end

-- FPS Boost
local Lighting = game:GetService("Lighting")
local Terrain = workspace:FindFirstChildOfClass("Terrain")
sethiddenproperty(Terrain, "Decoration", false)
sethiddenproperty(game.Lighting, "Technology", 0)
settings().Rendering.QualityLevel = 1
Lighting.Brightness = 0
if DitPSX["White Screen"] then
    game:GetService("RunService"):Set3dRenderingEnabled(false)
end
spawn(function()
    -- local FPSboost 
    -- FPSboost = hookfunction(getsenv(plr.PlayerScripts.Scripts.Game.Coins).CoinDamageAnimation, function(p10, p11)
    --     return nil
    -- end)
    getsenv(plr.PlayerScripts.Scripts.Game.Coins).CoinDamageAnimation = function() end
end)

function SendWebHook(v, x)
    http_request({
        Url = x,
        Method = "POST",
        Headers = {
            ["Content-Type"] = "application/json"
        },
        Body = game:GetService("HttpService"):JSONEncode({
            ["embeds"] = {{
                ["title"] = "Pet Simulator X",
                ["type"] = "rich",
                ["color"] = tonumber(0x04BBFF),
                ["fields"] = {
                    v,
                },
                ["footer"] = {
                    ["icon_url"] = "https://media.discordapp.net/attachments/832898415083913237/1116993951132549180/psx.png",
                    ["text"] = "Dit PSX - Make life easier"
                }
            }}
        })
    })
end

spawn(function()
    while wait(.25) do
        local TotalTime = game.workspace.DistributedGameTime
        local Sec = math.round(TotalTime % 60)
        local Min = math.floor(TotalTime / 60 % 60)
        local Hour = math.floor(TotalTime / 3600)
        if Sec == 60 then Sec = 0 Min = Min + 1 end
        if Min == 60 then Min = 0 Hour = Hour + 1 end
        local SecFormat = "" if string.len(Sec) == 1 then SecFormat = "0" end
        local MinFormat = "" if string.len(Min) == 1 then MinFormat = "0" end
        local HourFormat = "" if string.len(Hour) == 1 then HourFormat = "0" end
        getgenv().S_Timer = string.format(MinFormat .. '%.0f:' .. SecFormat .. '%.0f', Min, Sec)
        if Hour >= 1 then
            getgenv().S_Timer = string.format(HourFormat .. '%.0f:', Hour) .. getgenv().S_Timer
        end
    end
end)
function SetText(v, x)
    v.Amount.Text = tostring(x)
    if v:FindFirstChild("Amount_odometerGUIFX") then
        v.Amount_odometerGUIFX.Text = tostring(x)
    end
end
spawn(function()
    DiamondsGained = plr.PlayerGui.Main.Right.Diamonds:Clone()
    DiamondsGained.Name = "Diamonds Gained"
    DiamondsGained.LayoutOrder = 99998995 + 100
    --DiamondsGained.UIScale.Scale = 0.9
    DiamondsGained.Parent = plr.PlayerGui.Main.Right
    DiamondsGained.Icon.Image = "rbxassetid://6248942117"
    DiamondsGained.Icon.Size = UDim2.new(0.25, 4, 1.79999995, 4)
    DiamondsGained.Icon.Rotation = 90
    DiamondsGained.Icon.Position = UDim2.new(0.954999983, 2, 0.5, 0)
    DiamondsGained.Add.Visible = false
    if DiamondsGained:FindFirstChild("Amount_odometerGUIFX") then
        DiamondsGained.Amount_odometerGUIFX["Diamonds Gradient"].Color = ColorSequence.new({
            ColorSequenceKeypoint.new(0, Color3.new(189/255, 207/255, 70/255)),
            ColorSequenceKeypoint.new(0.432612, Color3.new(189/255, 207/255, 70/255)),
            ColorSequenceKeypoint.new(1, Color3.new(53/255, 54/255, 49/255))
        })
    end
    SetText(DiamondsGained, "Script by egoD\nLoading script...")
    getgenv().OldDiamond = plr.leaderstats.Diamonds.Value
    getgenv().SentDiamond = 0
    wait(5)
    while wait(.5) do
        pcall(function()
            if StartedHopServer then
                SetText(DiamondsGained, "Hopping Server")
                if DitPSX["Discord Webhook"]
                and DitPSX["Discord Webhook"]["Hop Server"]
                and string.find(DitPSX["Discord Webhook"]["Hop Server"], "discord")
                and not SWH then
                    SendWebHook({
                        ["name"] = "Hop Server",
                        ["value"] = "Account: ||" .. plr.Name .. "||\n\nTotal Gem: " .. tostring(shortNumber(plr.leaderstats.Diamonds.Value)) .. "\nGem Gained: " .. tostring(shortNumber(tonumber(dg))) .. "\nTime: " .. tostring(S_Timer),
                        ["inline"] = false
                    }, DitPSX["Discord Webhook"]["Hop Server"])
                    getgenv().SWH = true
                end
            else
                local countdg = (plr.leaderstats.Diamonds.Value + SentDiamond) - OldDiamond
                getgenv().dg = countdg
                getgenv().dg2 = formatNumber(countdg)
                SetText(DiamondsGained, dg2 .. "\n" .. S_Timer)
            end
        end)
    end
end)

--Disable UIs
--[[
if game.CoreGui.RobloxGui:FindFirstChild("PerformanceStats") then 
    UserSettings().GameSettings.PerformanceStatsVisible = false
end
if game.StarterGui:GetCoreGuiEnabled("PlayerList") then
    game.StarterGui:SetCore('TopbarEnabled', false)
end
game.CoreGui:FindFirstChild("RobloxGui").Enabled = false
game:GetService("VirtualInputManager"):SendKeyEvent(true, 27, false, game)
game:GetService("VirtualInputManager"):SendKeyEvent(false, 27, false, game)
plr.PlayerGui.Message.Enabled = false
plr.PlayerGui.Message:GetPropertyChangedSignal("Enabled"):Connect(function()
    plr.PlayerGui.Message.Enabled = false
end)
]]
plr.PlayerGui.FreeGiftsTop.Enabled = false
plr.PlayerGui.Main.Left.Visible = false
plr.PlayerGui.Main.Right.Diamonds.Add.Visible = false
plr.PlayerGui.Main.Right.Rank.Visible = false
plr.PlayerGui.Main.Bottom.Visible = false
for i, v in ipairs(plr.PlayerGui.Main.Boosts:GetChildren()) do
    if v:IsA("Frame")
    and not string.find(v.Name, "Damage")
    and v.Name ~= "Apple" and v.Name ~= "Orange" then
        v.Visible = false
    end
end
pcall(function()
    plr.PlayerGui.Main.EventHud.Visible = false
    plr.PlayerGui.Main.EventHud:GetPropertyChangedSignal("Visible"):Connect(function()
        plr.PlayerGui.Main.EventHud.Visible = false
    end)
end)

if DitPSX["Auto Leave"]["Ping Froze"] then 
    spawn(function()
        function GetPing()
            return game:GetService("Stats").Network.ServerStatsItem["Data Ping"]:GetValue()
        end
        function AntiFrozePing()
            local CurrentPing = GetPing()
            if CurrentPing == 0 then return end
            if NewPing and NewPing == GetPing() then
                LastCheck = tick()
            else
                NewCheck = tick()
            end
            if LastCheck and NewCheck
            and LastCheck - NewCheck > 20 then 
                LeaveOrHop()
            end
            NewPing = GetPing()
        end
        while wait(1) do
            pcall(function()
                AntiFrozePing()
            end)
        end
    end)
end
if DitPSX["Auto Leave"]["Got kicked"] then 
    spawn(function()
        while wait(5) do
            pcall(function()
                if game.CoreGui.RobloxPromptGui.promptOverlay:FindFirstChild("ErrorPrompt")
                and not string.find(game.CoreGui.RobloxPromptGui.promptOverlay:FindFirstChild("ErrorPrompt").MessageArea.ErrorFrame.ErrorMessage.Text, "Attempted to teleport to a place that is restricted") then
                    LeaveOrHop()
                end
            end)
        end
    end)
end
if DitPSX["Auto Leave"]["Leave Timer"].Enable then 
    spawn(function()
        local TimerLeave = tick()
        while wait(5) do
            pcall(function()
                if tick() - TimerLeave >= DitPSX["Auto Leave"]["Leave Timer"]["After seconds"] then
                    LeaveOrHop()
                end
            end)
        end
    end)
end
spawn(function()
    while wait(2) do
        if plr.PlayerGui.Loading.Enabled then
            local TimerLoading = tick()
            while plr.PlayerGui.Loading.Enabled do wait()
                if tick() - TimerLoading > 30 then
                    LeaveOrHop()
                end
            end
        end
    end
end)
local connect
local old
old = hookmetamethod(game,"__index",function(...) 
    if checkcaller() then return old(...) end
    if not connect then 
        connect = Instance.new("BindableFunction")
        connect.OnInvoke = function(f) 
            return f()
        end
    end
    return old(...)
end)
repeat wait() until connect
function warpF2(f) 
    return connect:Invoke(f)
end
local vu = game:GetService("VirtualUser")
plr.Idled:connect(function()
    vu:Button2Down(Vector2.new(0,0),workspace.CurrentCamera.CFrame)
    wait(1)
    vu:Button2Up(Vector2.new(0,0),workspace.CurrentCamera.CFrame)
end)

if setfflag then 
    setfflag("HumanoidParallelRemoveNoPhysics", "False")
    setfflag("HumanoidParallelRemoveNoPhysicsNoSimulate2", "False")
end
getgenv().F_Lib = require(game.ReplicatedStorage.Framework.Library)
getgenv().L_Client = require(game.ReplicatedStorage.Library.Client)
getgenv().L_Directory = require(game.ReplicatedStorage.Library.Directory)
getgenv().wThings = workspace.__THINGS
getgenv().formatNumber = F_Lib.Functions.Commas
getgenv().shortNumber = F_Lib.Functions.NumberShorten

local Library = require(game.ReplicatedStorage.Library)
debug.setupvalue(L_Client.Network.Invoke, 1, function() return true end)
wait(1)
debug.setupvalue(L_Client.Network.Fire, 1, function() return true end)
wait(1)
require(game.ReplicatedStorage.Framework.Library).WorldCmds.CanDoAction = function() return true end
wait(1)
for i, v in ipairs(F_Lib.Save.Get().Gamepasses) do
    if v == 18674305 then
        getgenv().VIPOwned = true
    end
end

if DitPSX["Discord Webhook"]
and DitPSX["Discord Webhook"]["Stats Tracker"]
and string.find(DitPSX["Discord Webhook"]["Stats Tracker"]["Url"], "discord") then
    repeat wait()
    until dg and S_Timer
    spawn(function()
        wait(3)
        while wait() do
            pcall(function()
                SendWebHook({
                    ["name"] = "Stat Tracker",
                    ["value"] = "Account: ||" .. plr.Name .. "||\n\nTotal Gem: " .. tostring(shortNumber(plr.leaderstats.Diamonds.Value)) .. "\nGem Gained: " .. tostring(shortNumber(tonumber(dg))) .. "\nTime: " .. tostring(S_Timer),
                    ["inline"] = false
                }, DitPSX["Discord Webhook"]["Stats Tracker"]["Url"])
                local Timer = tick()
                repeat wait(1)
                until tick() - Timer >= DitPSX["Discord Webhook"]["Stats Tracker"]["Cooldown"]
            end)
        end
    end)
end

function Optimize()
    workspace.__DEBRIS:Destroy()

    game:GetService("ReplicatedStorage").Assets.Billboards.Orb.Enabled = true
    game:GetService("ReplicatedStorage").Assets.Billboards.Reward.Enabled = true

    spawn(function()
        while wait() do
            pcall(function()
                local m = workspace.__MAP:FindFirstChild("Areas")
                if m then m:Destroy() wait(10) end
            end)
            wait(5)
        end
    end)
    
    for i, v in ipairs(workspace.__THINGS.Coins:GetChildren()) do
        if v:FindFirstChild("Coin") then
            pcall(function()
                v.Coin.MeshId = ""
            end)
            pcall(function()
                v.Coin.TextureID = ""
            end)
        end
    end
    for i, v in ipairs(game.ReplicatedStorage.Assets.CoinAssets:GetDescendants()) do
        if v:IsA("MeshPart") then
            pcall(function()
                v.MeshId = ""
            end)
            pcall(function()
                v.TextureID = ""
            end)
        end
    end
    for i, v in ipairs(game.ReplicatedStorage.Assets.Models.Lootbags:GetDescendants()) do
        if v:IsA("MeshPart") then
            pcall(function()
                v.MeshId = ""
            end)
            pcall(function()
                v.TextureID = ""
            end)
        end
    end
   
    for k, v in ipairs(game:GetService("ReplicatedStorage").Assets.Particles:GetDescendants()) do 
        if v:IsA("ParticleEmitter") then 
            v.Enabled = false
            v.Texture = ""
            v.Brightness = 0
        end
    end

    spawn(function()
        while wait(10) do 
            for k,v in ipairs(game.Players:GetChildren()) do
                if v.Name ~= plr.name then 
                    pcall(function() 
                        v.Character:Destroy()    
                    end)    
                end
            end
        end
    end)
end

if not Run1Time then

    if DitPSX["Send all"] then
        Library.Save.Get().Settings.PetsControl = 2
    else
        Library.Save.Get().Settings.PetsControl = 1
    end
    getsenv(plr.PlayerScripts.Scripts.GUIs.Settings).Update()

    getgenv().noclip = true

    pcall(Optimize)

    local LootbagCollect = getsenv(plr.PlayerScripts.Scripts.Game.Lootbags)
    function CollectLoots()
        for i, v in ipairs(wThings.Lootbags:GetChildren()) do 
            LootbagCollect.Collect(v)
        end
    end
    spawn(function()
        while wait() do
            pcall(function()
                CollectLoots()
                if not StartedHopServer then wait(1) end
            end)
        end
    end)
    
    local huhu = getsenv(game.Players.LocalPlayer.PlayerScripts.Scripts.Game.Orbs)
    local Collect = huhu.Collect
    local list = {}
    local getupval = debug.getupvalue
    huhu.AddOrb = function(a,b) 
        table.insert(list,a)
    end
    getgenv().Collect = function()
        if #list == 0 then return end
        local upval = getupval(Collect,3)
        for k,v in ipairs(list) do 
            table.insert(upval,v)
        end
        table.clear(list)
    end
    spawn(function()
        while wait(1) do getgenv().Collect() end
    end)

    -- shout out to rafa
    local WorldCoins = F_Lib.Things:WaitForChild("Coins")
    WorldCoins.ChildAdded:Connect(function(v)
        v:SetAttribute("HasLanded", true)
        v:SetAttribute("IsFalling", false)
        local x = v:WaitForChild("Coin")
        x:SetAttribute("InstantLand", true)
    end)

    local Original_HasPower = F_Lib.Shared.HasPower
    F_Lib.Shared.HasPower = function(pet, powerName) 
        if powerName == "Agility" then 
            return true, 3
        end
        return Original_HasPower(pet, powerName)
    end
    
    local Original_GetPowerDir = F_Lib.Shared.GetPowerDir
    F_Lib.Shared.GetPowerDir = function(powerName, tier) 
        if powerName == "Agility" then 
            return  {
                title = "Agility III", 
                desc = "Pet moves 50% faster", 
                value = 20
            }
        end
        return Original_GetPowerDir(powerName, tier)
    end

    function Noclip()
        for i, v in ipairs(plr.Character:GetDescendants()) do
            if v:IsA("BasePart") and v.CanCollide == true then
                v.CanCollide = false
            end
        end
    end
    getgenv().noclip = true
    game:GetService("RunService").Stepped:Connect(function()
        if getgenv().noclip then
            if plr.Character ~= nil then
                if setfflag then 
                    local x = plr.Character:FindFirstChild("Humanoid")
                    if x then x:ChangeState(11) end
                else
                    Noclip()
                end
            end
        end
    end)
    if not setfflag then 
        spawn(function()
            while wait() do
                pcall(function()
                    if noclip and not plr.Character.HumanoidRootPart:FindFirstChild("coems") then
                        local BV = Instance.new("BodyVelocity", plr.Character.HumanoidRootPart)
                        BV.Name = "coems"
                        BV.Velocity = Vector3.new(0, 0, 0)
                        BV.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
                    end
                    repeat wait()
                    until not plr.Character.HumanoidRootPart:FindFirstChild("coems")
                end)
            end
        end)
    end

    getgenv().DisableFarmCyber = true
    delay(20, function()
        getgenv().DisableFarmCyber = false
    end)

    getgenv().Run1Time = true
end

function GetFruitAmount(x)
    local Directory = F_Lib.FruitCmds.Directory
    if Directory[x] then 
        return math.round(F_Lib.FruitCmds.Get(F_Lib.LocalPlayer, Directory[x])) or 0
    end
end
function CheckBreakable(i, v)
    if wThings.Coins:FindFirstChild(i)
    and ((wThings.Coins[i].POS:FindFirstChild("HUD") and wThings.Coins[i].POS.HUD.ProgressText.Text ~= "0") or not wThings.Coins[i]:FindFirstChild("HUD"))
    and v.h > 0 then
        return true
    end
end
local PrioFruits = {
    Rainbow = true,
    Orange = true,
    Apple = true,
}
local Library = require(game.ReplicatedStorage.Library)
getgenv().GetBreakable = function(in_area, x)
    if x then
        local P_Breakable = {}
        local Breakable = {}
        local P_BreakAdded = false
        for i, v in pairs(L_Client.Network.Invoke("Get Coins")) do
            if v.a == in_area then
                if CheckBreakable(i, v) then
                    if PrioFruits[v.n]
                    or (not DitPSX["Ignore Giant Chest"] and v.n == "Mystic Mine Diamond Mine Giant Chest") then
                        table.insert(P_Breakable, i)
                        P_BreakAdded = true
                    elseif not P_BreakAdded then
                        table.insert(Breakable, i)
                    end
                end
            end 
        end
        if P_BreakAdded then
            return P_Breakable
        else
            return Breakable
        end
    else
        local NotSendAllPart
        local FoundPart
        local count = 0
        for i, v in ipairs(game.Workspace.__THINGS.Coins:GetChildren()) do 
            if v:IsA("Folder")
            and v:GetAttribute("Area") == in_area
            and v:GetAttribute("Health") > 0 then
                count = count + 1 
                local name = v:GetAttribute("Name")
                if PrioFruits[name]
                or not DitPSX["Ignore Giant Chest"] and name == "Mystic Mine Diamond Mine Giant Chest" then
                    return v, count
                end
                if not DitPSX["Send all"] then
                    if not v.POS:FindFirstChild("HUD") then
                        NotSendAllPart = v
                    end
                end
                if not FoundPart then FoundPart = v end
            end
        end
        if NotSendAllPart then return NotSendAllPart, count end
        return FoundPart, count
    end
end
function GetCurrentWorld()
    return F_Lib.WorldCmds.Get()
end
local TeleportENV = getsenv(plr.PlayerScripts.Scripts.GUIs.Teleport)
function HMS_To_Number(v)
	local sec = 0
	v = v:split(":")
	local h, m, s = v[1], v[2], v[3]
	h, m, s = tonumber(h) or 0, tonumber(m) or 0, tonumber(s) or 0
	if h > 0 then
		sec = sec + 3600 * h
	end
	if m > 0 then
		sec = sec + 60 * m
	end
	sec = sec + s
	return sec
end
function IsMineCollapsed()
    if workspace.__MAP.Interactive:FindFirstChild("Diamond Mine Collapsed Sign")
    and workspace.__MAP.Interactive["Diamond Mine Collapsed Sign"].Main.SurfaceGui.Enabled then
        return true
    end
end
function SetTempFarmFruit()
    local TimeLeft = HMS_To_Number(workspace.__MAP.Interactive["Diamond Mine Collapsed Sign"].Main.SurfaceGui.Timer.Text:split("in:")[2])
    getgenv().FarmFruit = true
    getgenv().TempDisableCheckFruit = true
    delay(TimeLeft + 5, function()
        getgenv().FarmFruit = false
        getgenv().TempDisableCheckFruit = false
        TeleportArea("Spawn")
    end)
end
function TeleportArea(area)
    if area == "Mystic Mine" and GetCurrentWorld() == "Spawn" and IsMineCollapsed() then
        return SetTempFarmFruit()
    end
    TeleportENV.Teleport(area, true)
    wait(3)
    if area == "Mystic Mine" and GetCurrentWorld() ~= area and IsMineCollapsed() then
        SetTempFarmFruit()
    end
end
function IsPlayerNearDiamondFarm()
    for i, v in ipairs(game.Players:GetChildren()) do
        if v.Name ~= plr.Name and v:DistanceFromCharacter(Vector3.new(9022, -20, 2507)) < 250 then
            return true
        end
    end
end
function DaycareReady()
    local Saves = F_Lib.Save.Get()
    assert(Saves)
    local DCQueue
	if Library.Shared.IsHardcore then
		DCQueue = Saves.DaycareHardcoreQueue
	else
		DCQueue = Saves.DaycareQueue
	end
    for i, v in ipairs(DCQueue) do 
        if Library.Shared.DaycareComputeRemainingTime(Saves, v) == 0 then 
            return true 
        end
    end
end
local DaycareGUI = getsenv(plr.PlayerScripts.Scripts.GUIs.Daycare)
function CheckPetEnrollable(v, Enrolls, E_Pets, DC_MaxSlot)
    if not table.find(Enrolls, v.uid)
    and not table.find(E_Pets, v.uid)
    and not v.l
    and DaycareGUI.GetUsedSlots() + #Enrolls < DC_MaxSlot then
        return true
    end
end
function GetEnrollPet()
    local Enrolls, I_Pets, DC_MaxSlot = {}, F_Lib.Save.Get().Pets, DaycareGUI.GetMaxSlots()
    local E_Pets = {}
    for i, v in pairs(L_Client.PetCmds.GetEquipped()) do
        table.insert(E_Pets, v.uid)
    end
    for i, v in pairs(I_Pets) do
        if v.dm
        and CheckPetEnrollable(v, Enrolls, E_Pets, DC_MaxSlot) then
            table.insert(Enrolls, v.uid)
        end
    end
    for i, v in pairs(I_Pets) do
        if v.r
        and CheckPetEnrollable(v, Enrolls, E_Pets, DC_MaxSlot) then
            table.insert(Enrolls, v.uid)
        end
    end
    for i, v in pairs(I_Pets) do
        if v.g
        and CheckPetEnrollable(v, Enrolls, E_Pets, DC_MaxSlot) then
            table.insert(Enrolls, v.uid)
        end
    end
    for i, v in pairs(I_Pets) do
        if CheckPetEnrollable(v, Enrolls, E_Pets, DC_MaxSlot) then
            table.insert(Enrolls, v.uid)
        end
    end
    return Enrolls
end
for i, v in ipairs(getgc()) do 
    if islclosure(v) and tostring(getfenv(v).script) == "Pets" then 
        for _, x in ipairs(debug.getconstants(v)) do 
            if x == "Pets.Remove" then
                getgenv().PetFunction = v
                break
            end
        end
        if getgenv().PetFunction then break end
    end
end
if getgenv().PetFunction then 
    getgenv().IsPetBusyValue = debug.getupvalues(getgenv().PetFunction)[1]
    getgenv().IsPetBusy = function(uid)
        local PetPath = getgenv().IsPetBusyValue[uid]
        return PetPath.farming or false
    end
end
local EquippedPets = L_Client.PetCmds.GetEquipped()
function GetEquippedPets()
    local E_Pets = {}
    for i, v in ipairs(EquippedPets) do
        table.insert(E_Pets, v.uid)
    end
    return E_Pets
end
function IfAFreePet()
    for i, v in ipairs(EquippedPets) do
        if not IsPetBusy(v.uid) then
            return true
        end
    end
end
function IsRewardReady(R_Cooldown, R_Timer)
    m = L_Client.Network.Invoke("Get OSTime") - R_Cooldown - R_Timer
    if m > 0 then return true end
end
function Ditting_PSX()
    if not LastRewardCheck or tick() - LastRewardCheck > 120 then
        if VIPOwned and IsRewardReady(14400, F_Lib.Save.Get().VIPCooldown) then
            print'1'
            TeleportArea("Spawn")
            local VIPRewardPath = game.workspace.__MAP.Interactive:FindFirstChild("VIP Rewards")
            if VIPRewardPath then
                getgenv().noclip = true
                plr.Character.HumanoidRootPart.CFrame = VIPRewardPath.Pad.CFrame 
                wait(1)
                L_Client.Network.Invoke("Redeem VIP Rewards")
            end
        end
        if IsRewardReady(L_Directory.Ranks[F_Lib.Save.Get().Rank].rewardCooldown, F_Lib.Save.Get().RankTimer) then
            print'2'
            TeleportArea("Spawn")
            local RankRewardPath = game.workspace.__MAP.Interactive:FindFirstChild("Rank Rewards")
            if RankRewardPath then
                getgenv().noclip = true
                plr.Character.HumanoidRootPart.CFrame = RankRewardPath.Pad.CFrame 
                wait(1)
                L_Client.Network.Invoke("Redeem Rank Rewards")
            end
        end
        for i, v in ipairs(L_Directory.FreeGifts) do 
            if not table.find(F_Lib.Save.Get().FreeGiftsRedeemed, i)
            and v.waitTime <= F_Lib.Save.Get().FreeGiftsTime then
                L_Client.Network.Invoke("Redeem Free Gift", i)
            end
        end
        getgenv().LastRewardCheck = tick()
    end
    if DitPSX["Auto Daycare"] and (not LastCheckDaycare or tick() - LastCheckDaycare > 120) then
        getgenv().LastCheckDaycare = tick()
        local EnrollPets = GetEnrollPet()
        if #EnrollPets == 0 then return end
        local Req1, Req2 = DaycareReady(), DaycareGUI.GetUsedSlots() < DaycareGUI.GetMaxSlots() and #EnrollPets > 0
        if Req1 or Req2 then
            print'3'
            TeleportArea("Spawn")
            local DaycarePath = game.workspace.__MAP.Interactive:FindFirstChild("Daycare")
            if DaycarePath then
                getgenv().noclip = true
                plr.Character.HumanoidRootPart.CFrame = DaycarePath.Pad.CFrame 
                wait(1)
                if Req1 then
                    L_Client.Network.Invoke("Daycare: Claim")
                    wait(2)
                    return
                else
                    L_Client.Network.Invoke("Daycare: Enroll", EnrollPets)
                    wait(2)
                end
            end
        end
    end
    if DitPSX["Auto Mailbox"].Enable and plr.Name ~= DitPSX["Auto Mailbox"]["Send to"] and plr.leaderstats.Diamonds.Value >= DitPSX["Auto Mailbox"]["Above amount"] then
        local MailboxPad = game.workspace.__MAP.Interactive.Mailbox.Pad
        getgenv().noclip = true
        plr.Character.HumanoidRootPart.CFrame = MailboxPad.CFrame
        wait(1)
        if plr:DistanceFromCharacter(MailboxPad.Position) < 8 then 
            local TotalDiamond = plr.leaderstats.Diamonds.Value - 100000
            L_Client.Network.Invoke("Send Mail", {
                Recipient = DitPSX["Auto Mailbox"]["Send to"], 
                Message = "Dit PSX", 
                Pets = {}, 
                Diamonds = TotalDiamond,
            })
            getgenv().SentDiamond = SentDiamond + TotalDiamond
            if DitPSX["Discord Webhook"]
            and DitPSX["Discord Webhook"]["Mailbox"]
            and string.find(DitPSX["Discord Webhook"]["Mailbox"], "discord") then
                SendWebHook({
                    ["name"] = "Send Mailbox",
                    ["value"] = "Account: ||" .. plr.Name .. "||\n\nGem Sent: " .. tostring(shortNumber(TotalDiamond)),
                    ["inline"] = false
                }, DitPSX["Discord Webhook"]["Mailbox"])
            end
            wait(2)
        end
    end
    if DitPSX["Auto Claim Mailbox"] and (not LastCheckMail or tick() - LastCheckMail > 60) then
        local GiftsUUID = {}
        local DiamondCount = 0
        local Mail = F_Lib.Network.Invoke("Get Mail")
        pcall(function()
            if Mail.Inbox then
                for i, v in ipairs(Mail.Inbox) do
                    if v.Message == "Dit PSX" then
                        table.insert(GiftsUUID, v.uuid)
                        DiamondCount = DiamondCount + v.Diamonds
                    end
                end
                if #GiftsUUID ~= 0 then
                    local MailboxPad = game.workspace.__MAP.Interactive.Mailbox.Pad
                    getgenv().noclip = true
                    plr.Character.HumanoidRootPart.CFrame = MailboxPad.CFrame
                    wait(1)
                    if plr:DistanceFromCharacter(MailboxPad.Position) < 8 then 
                        F_Lib.Network.Invoke("Claim Mail", GiftsUUID)
                        if DitPSX["Discord Webhook"]
                        and DitPSX["Discord Webhook"]["Mailbox"]
                        and string.find(DitPSX["Discord Webhook"]["Mailbox"], "discord") then
                            SendWebHook({
                                ["name"] = "Claim Mailbox",
                                ["value"] = "Account: ||" .. plr.Name .. "||\n\nTotal Gem: " .. tostring(shortNumber(plr.leaderstats.Diamonds.Value)) .. "\nTotal Gem Claimed: " .. tostring(shortNumber(DiamondCount)),
                                ["inline"] = false
                            }, DitPSX["Discord Webhook"]["Mailbox"])
                        end
                    end
                end
            end
        end)
        getgenv().LastCheckMail = tick()
    end
    local V_World, V_Area, V_Pos = "Diamond Mine", "Mystic Mine", CFrame.new(9022, -40, 2507)
    if TempFarmCyber then
        V_Area, V_Pos = "Cyber Cavern", CFrame.new(8784, -40, 3037)
    end
    if not TempDisableCheckFruit and DitPSX["Auto Farm Fruit"].Enable and (not LastCheckFruit or tick() - LastCheckFruit > 60) then
        getgenv().LastCheckFruit = tick()
        local Apple, Orange = GetFruitAmount("Apple"), GetFruitAmount("Orange")
        if FarmFruit and Apple > 195 and Orange > 195 then
            getgenv().FarmFruit = false
            print'4'
            TeleportArea("Spawn")
            return
        elseif Apple <= DitPSX["Auto Farm Fruit"]["Farm when under"] or Orange <= DitPSX["Auto Farm Fruit"]["Farm when under"] then
            getgenv().FarmFruit = true
        end
        return
    elseif FarmFruit then
        V_World, V_Area, V_Pos = "Pixel", "Pixel Vault", CFrame.new(3553, -40, 2458)
    end
    if plr:DistanceFromCharacter(V_Pos.Position) > 20 then
        if GetCurrentWorld() ~= V_World then
            TeleportArea(V_Area)
        end
        getgenv().noclip = true
        plr.Character.HumanoidRootPart.CFrame = V_Pos
    else
        if DitPSX["Performance Mode"] then
            if not DitPSX["Send all"] and not IfAFreePet() then return wait() end
            local Breakable, B_Counts = GetBreakable(V_Area)
            if Breakable then
                if DitPSX["Swap to Cyber Cavern"]
                and (not Breakable and V_Area == "Mystic Mine" and not TempFarmCyber and not DisableFarmCyber) then
                    V_Area, V_Pos = "Cyber Cavern", CFrame.new(8784, -40, 3037)
                    getgenv().TempFarmCyber = true
                    delay(30, function()
                        getgenv().TempFarmCyber = false
                        getgenv().DisableFarmCyber = true
                        delay(20, function()
                            getgenv().DisableFarmCyber = false
                        end)
                    end)
                end
                if not StartedHopServer
                and DitPSX["Hop Server"]["Out of diamond"] and not FarmFruit
                and not Breakable and (not DitPSX["Swap to Cyber Cavern"] or DisableFarmCyber)
                and (not LastHopTick or tick() - LastHopTick >= DitPSX["Hop Server"]["Hop Server Cooldown"]) then
                    queue_on_teleport("getgenv().LastHopTick = " .. tick())
                    getgenv().hopserver:Fire()
                    return
                end
                if not StartedHopServer
                and DitPSX["Hop Server"]["Player nearby"] and not FarmFruit
                and not Breakable and (not DitPSX["Swap to Cyber Cavern"] or DisableFarmCyber)
                and (not LastHopTick or tick() - LastHopTick >= DitPSX["Hop Server"]["Hop Server Cooldown"]) and IsPlayerNearDiamondFarm() then
                    queue_on_teleport("getgenv().LastHopTick = " .. tick())
                    getgenv().hopserver:Fire()
                    return
                end
                if DitPSX["White Screen"] then
                    if game.workspace.Camera.CameraType == Enum.CameraType.Custom then
                        game.workspace.Camera.CFrame = CFrame.new(0, 1000, 0, 0, -1, 0, 0, 0, -1, -1, 0, 0)
                        game.workspace.Camera.CameraType = Enum.CameraType.Scriptable
                    end
                else
                    local m = Breakable.POS.Position
                    game.workspace.Camera.CFrame = CFrame.new(m.X, m.Y + 40, m.Z, 0, -1, 0, 0, 0, 1, -1, 0, 0)
                    game.workspace.Camera.CameraType = Enum.CameraType.Scriptable
                end
                --Instance.new("BoolValue",Breakable).Name = "vohoangnang"
                spawn(function()
                    if B_Counts <= 5 then
                        Library.Signal.Fire("Group Select Coin", Breakable)
                    else
                        Library.Signal.Fire("Select Coin", Breakable)
                    end
                end)
                if DitPSX["Send all"] or B_Counts == 1 then
                    repeat wait()
                    until not Breakable or not Breakable.Parent
                    or not Breakable:FindFirstChild("HUD", true)
                    or Breakable.POS.HUD.ProgressText.Text == "0"
                end
                wait(DitPSX["Farm Cooldown"])
            else
                game.workspace.Camera.CameraType = Enum.CameraType.Custom
            end
        else
            local Breakables = GetBreakable(V_Area, true)
            if DitPSX["Swap to Cyber Cavern"]
            and (#Breakables < 5 and V_Area == "Mystic Mine" and not TempFarmCyber and not DisableFarmCyber) then
                V_Area, V_Pos = "Cyber Cavern", CFrame.new(8784, -40, 3037)
                getgenv().TempFarmCyber = true
                delay(30, function()
                    getgenv().TempFarmCyber = false
                    getgenv().DisableFarmCyber = true
                    delay(20, function()
                        getgenv().DisableFarmCyber = false
                    end)
                end)
            end
            if DitPSX["Hop Server"]["Out of diamond"] and not FarmFruit
            and #Breakables == 0 and (not DitPSX["Swap to Cyber Cavern"] or DisableFarmCyber)
            and (not LastHopTick or tick() - LastHopTick >= DitPSX["Hop Server"]["Hop Server Cooldown"]) then
                queue_on_teleport("getgenv().LastHopTick = " .. tick())
                getgenv().hopserver:Fire()
                return
            end
            if DitPSX["Hop Server"]["Player nearby"] and not FarmFruit
            and #Breakables == 0 and (not DitPSX["Swap to Cyber Cavern"] or DisableFarmCyber)
            and (not LastHopTick or tick() - LastHopTick >= DitPSX["Hop Server"]["Hop Server Cooldown"]) and IsPlayerNearDiamondFarm() then
                queue_on_teleport("getgenv().LastHopTick = " .. tick())
                getgenv().hopserver:Fire()
                return
            end
            if #Breakables ~= 0 then
                local P_List = GetEquippedPets()
                if #P_List == 0 then return end
                local B_Count = 0
                local P_Count = 1
                spawn(function()
                    for i, v in ipairs(Breakables) do
                        pcall(function()
                            if v and wThings.Coins:FindFirstChild(v) then
                                if DitPSX["White Screen"] then
                                    if game.workspace.Camera.CameraType == Enum.CameraType.Custom then
                                        game.workspace.Camera.CFrame = CFrame.new(0, 1000, 0, 0, -1, 0, 0, 0, -1, -1, 0, 0)
                                        game.workspace.Camera.CameraType = Enum.CameraType.Scriptable
                                    end
                                else
                                    local m = wThings.Coins[v].POS.Position
                                    game.workspace.Camera.CFrame = CFrame.new(m.X, m.Y + 40, m.Z, 0, -1, 0, 0, 0, 1, -1, 0, 0)
                                    game.workspace.Camera.CameraType = Enum.CameraType.Scriptable
                                end
                                if V_Area == "Mystic Mine" and #Breakables == 1
                                or DitPSX["Send all"] and not FarmFruit then
                                    --Instance.new("BoolValue",wThings.Coins[v]).Name = "vohoangnang"
                                    L_Client.Network.Invoke('Join Coin', v, P_List)
                                    for _, x in ipairs(P_List) do
                                        L_Client.Network.Fire('Farm Coin', v, x)
                                    end
                                    repeat wait()
                                    until not wThings.Coins:FindFirstChild(v)
                                    or not wThings.Coins[v]:FindFirstChild("HUD", true)
                                    or wThings.Coins[v].POS.HUD.ProgressText.Text == "0"
                                    B_Count = B_Count + 1
                                else
                                    P_Count = P_Count + 1
                                    if #P_List <= P_Count then
                                        P_Count = 1 
                                    end
                                    L_Client.Network.Invoke('Join Coin', v, {P_List[P_Count]})
                                    L_Client.Network.Fire('Farm Coin', v, P_List[P_Count])
                                end
                            else
                                B_Count = B_Count + 1
                            end
                        end)
                        if FarmFruit or DitPSX["Send all"] then
                            task.wait()
                        else
                            task.wait(DitPSX["Farm Cooldown"])
                        end
                    end
                    table.clear(Breakables)
                end)
                if DitPSX["Send all"] and not FarmFruit then
                    repeat wait()
                    until B_Count >= #Breakables
                else
                    wait(DitPSX["Farm Cooldown"])
                end
            else
                game.workspace.Camera.CameraType = Enum.CameraType.Custom
            end
        end
    end
end

warpF2(function() 
    spawn(function()
        while wait() do
            --Ditting_PSX()
            pcall(Ditting_PSX)
        end
    end)
end)
-- haaa 
spawn(function()
    while wait(30) do
        pcall(function()
            if not FarmFruit then
                if DitPSX["Auto Triple Damage Boost"].Boost and not F_Lib.Save.Get().Boosts["Triple Damage"] then
                    L_Client.Network.Fire("Activate Boost", "Triple Damage")
                    local Timer = tick()
                    repeat wait(1)
                    until F_Lib.Save.Get().Boosts["Triple Damage"] or tick() - Timer > 5
                end
                if DitPSX["Auto Triple Damage Boost"].Server and not F_Lib.ServerBoosts.GetActiveBoosts()["Triple Damage"] then
                    L_Client.Network.Fire("Activate Server Boost", "Triple Damage")
                    local Timer = tick()
                    repeat wait(1)
                    until F_Lib.ServerBoosts.GetActiveBoosts()["Triple Damage"] or tick() - Timer > 5
                end
            end
        end)
    end
end)
